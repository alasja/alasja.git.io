---
title: "几何阶段"
keywords: sample homepage
tags: [getting_started]
sidebar: rtr
layout: book
permalink: rtr_ch2_geometry.html
summary: 渲染管线。
---



### 2.3 几何阶段
几何阶段复杂大部分逐多边形和逐像素的操作。这个阶段被分为下面的多个功能阶段：模型及视角变换、顶点着色器、投影、裁剪及屏幕映射（见图2.3）。再次提醒，这些功能阶段是基于实现的，而不是必须要存在的。有些情况下，很多连续的功能阶段在一个流水线阶段就完成了。也有可能一个功能阶段被分割成多个流水线阶段。

![图2-3](/images/figure2_3.png)

某种极限情况下，流水线所有阶段可能都运行在一个处理器上，然后你可以说整条流水线就一个流水线阶段。实际上在处理器芯片集成之前，还真是这么搞得。另一种极端的情况是，每个功能阶段都被划分成多个更小的流水线阶段，然后每个小流水线阶段可以运行在特定的处理器核心上。

### 2.3.1 模型和视角变换
一个模型要显示到屏幕上，需要经历几次不同坐标空间的变换。最开始，模型在它自己的模型空间，这时候它还没有经历任何的变换。每个模型都可以关联一个**模型变换**，用于指定位置和朝向。一个模型可以关联多个模型变换。这可以让同一个模型在一个场景中存在多个复制体（叫实例），他们可以分别指定不同的位置和朝向，而不用复制原始模型来达到这个目的。

变换的时候，其实是顶点和法线在变换。模型的坐标系统被称为模型坐标系。在进行模型变换后，这个模型就在世界坐标系或者世界空间下了。世界坐标系是唯一的，不同的模型进行各自的变换后，所有的模型都会在同一个空间下了。

正如之前提到的，只有被相机看到的模型才会渲染。相机也有自己位置和方向用于定位和设置相机的朝向。为了更方便的进行投影和裁剪，相机和所有的模型都会变换到观察坐标系下。观察变换的目标是把相机放到原点并设置它的朝向z轴的负方向，并且y轴朝上，x轴朝右边。观察变换最终的位置和朝向取决于底层API。这个空间也被称为相机空间，或者通俗点叫眼睛空间。图2.4是观察变换如何作用相机和模型的示例。模型变换和相机变换都是4x4的矩阵，在第四章会深入探讨。

![图2-4](/images/figure2_4.png)


### 2.3.2 顶点着色器
